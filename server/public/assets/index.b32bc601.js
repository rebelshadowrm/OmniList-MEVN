var B=Object.defineProperty,q=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var D=(t,e,n)=>e in t?B(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,f=(t,e)=>{for(var n in e||(e={}))W.call(e,n)&&D(t,n,e[n]);if(F)for(var n of F(e))K.call(e,n)&&D(t,n,e[n]);return t},S=(t,e)=>q(t,J(e));import{r as v,o as c,c as l,a as r,b as w,w as C,p as $,d as k,e as E,F as M,f as h,g as d,v as p,t as x,h as y,i as Y,j as z,k as G,l as I,m as H,n as Q,q as N,s as X,u as Z,x as ee,y as te}from"./vendor.5c1cb479.js";const se=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}};se();var oe="/assets/logo.03d6d6da.png";var m=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n};const re={name:"Header"},ae=t=>($("data-v-b3ca5bba"),t=t(),k(),t),ne=ae(()=>r("img",{alt:"Vue logo",src:oe},null,-1)),ie={id:"nav"},ce=E("Home"),le=E("About");function de(t,e,n,i,s,a){const o=v("router-link");return c(),l("header",null,[ne,r("nav",ie,[w(o,{to:"/"},{default:C(()=>[ce]),_:1}),w(o,{to:"/about"},{default:C(()=>[le]),_:1})])])}var ue=m(re,[["render",de],["__scopeId","data-v-b3ca5bba"]]);const _e={name:"Footer"},pe=t=>($("data-v-328c9808"),t=t(),k(),t),me=pe(()=>r("p",null,"OmniList \xA9 2022",-1)),ge=[me];function he(t,e,n,i,s,a){return c(),l("footer",null,ge)}var ve=m(_e,[["render",he],["__scopeId","data-v-328c9808"]]);const fe={name:"App",components:{Header:ue,Footer:ve}};function ye(t,e,n,i,s,a){const o=v("Header"),g=v("router-view"),L=v("Footer");return c(),l(M,null,[w(o),r("main",null,[w(g)]),w(L)],64)}var be=m(fe,[["render",ye]]);const T="/api/posts/";class b{static getPosts(){return new Promise(async(e,n)=>{try{const s=(await h.get(T)).data;e(s.map(a=>S(f({},a),{createdAt:new Date(a.createdAt)})))}catch(i){n(i)}})}static insertPost(e){return h.post(T,{text:e})}static deletePost(e){return h.delete(`${T}${e}`)}}const we={name:"PostComponent",data(){return{posts:[],error:"",text:""}},async created(){try{this.posts=await b.getPosts()}catch(t){this.error=t.message}},methods:{async createPost(){await b.insertPost(this.text),this.posts=await b.getPosts(),this.text=""},async deletePost(t){await b.deletePost(t),this.posts=await b.getPosts()}}},V=t=>($("data-v-37eb1acf"),t=t(),k(),t),xe={class:"container"},$e=V(()=>r("h1",null,"Latest Posts",-1)),ke={class:"create-post"},Pe=V(()=>r("label",{for:"create-post"},"Say something...",-1)),Ie=V(()=>r("hr",null,null,-1)),Ae={key:0,class:"error"},Le={class:"posts-container"},Se=["onDblclick"],Ne={class:"created-at"},Te={class:"text"};function Ue(t,e,n,i,s,a){return c(),l("div",xe,[$e,r("div",ke,[Pe,d(r("input",{type:"text",id:"create-post","onUpdate:modelValue":e[0]||(e[0]=o=>s.text=o),placeholder:"Create a post"},null,512),[[p,s.text]]),r("button",{onClick:e[1]||(e[1]=(...o)=>a.createPost&&a.createPost(...o))},"Post!")]),Ie,s.error?(c(),l("p",Ae,x(s.error),1)):y("",!0),r("div",Le,[(c(!0),l(M,null,Y(s.posts,o=>(c(),l("div",{class:"post",key:o._id,onDblclick:g=>a.deletePost(o._id)},[r("div",Ne,x(`${o.createdAt.getDate()}/${o.createdAt.getMonth()}/${o.createdAt.getFullYear()}`),1),r("p",Te,x(o.text),1)],40,Se))),128))])])}var Me=m(we,[["render",Ue],["__scopeId","data-v-37eb1acf"]]);const A="/api/";class R{static async getUsers(){return new Promise(async(e,n)=>{try{const s=(await h.get(`${A}user`)).data;e(s.map(a=>S(f({},a),{createdAt:new Date(a.createdAt),updatedAt:new Date(a.updatedAt)})))}catch(i){n(i)}})}static async registerUser(e){try{return await h.post(`${A}register`,e)}catch(n){return n.response}}static async loginUser(e){try{return await h.post(`${A}login`,e)}catch(n){return n.response}}static async logoutUser(e){try{return await h.post(`${A}logout`,e)}catch(n){return n.response}}}class U{static getAccessToken(){return localStorage.getItem("access_token")}static setAccessToken(e){localStorage.setItem("access_token",e)}static setRefreshToken(e){localStorage.setItem("refresh_token",e)}static getRefreshToken(){return localStorage.getItem("refresh_token")}static clearTokens(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}}const u=z({userData:{user:null},isLoggedIn:!1,loading:!1,error:""}),Ve={getIsLoggedIn:()=>I(()=>u.isLoggedIn),getLoading:()=>I(()=>u.loading),getError:()=>I(()=>u.error),getUser:()=>I(()=>u.userData.user)},O={setUser:t=>{O.setIsLoggedIn(!0),u.userData.user=t},setIsLoggedIn:t=>{u.isLoggedIn=t,t===!1&&(u.userData.user=null,U.clearTokens())},setLoading:t=>{u.loading=t},setError:t=>{u.error=t}},Fe={decodeJWT:t=>{try{return JSON.parse(atob(t.split(".")[1]))}catch{return null}}};var j=()=>f(f(f({state:G(u)},Ve),O),Fe);const De={name:"Login",data(){return{email:"",password:"",errorMsg:""}},methods:{async login(){const{setUser:t,decodeJWT:e}=j();if(this.email.trim()!==""&&this.password.trim()!==""){const n={email:this.email,password:this.password},i=await R.loginUser(n);if(i.status===200){const{accessToken:s,refreshToken:a}=i.data,o=e(s);t(o),U.setAccessToken(s),U.setRefreshToken(a),this.email="",this.password=""}else this.errorMsg="Invalid login"}else this.errorMsg="Email and Password and required fields"},hasAccount(){this.$emit("toggle-form",!1)}}},P=t=>($("data-v-5e209e2c"),t=t(),k(),t),Ce=P(()=>r("h1",null,"Login",-1)),Ee={key:0,class:"error"},He={class:"input"},Re=P(()=>r("label",{for:"email"},"email",-1)),Oe={class:"input"},je=P(()=>r("label",{for:"password"},"password",-1)),Be=P(()=>r("input",{type:"submit",value:"login"},null,-1)),qe={class:"toggle"},Je=P(()=>r("p",null,"Don't have an account?",-1));function We(t,e,n,i,s,a){return c(),l("form",{onSubmit:e[3]||(e[3]=H((...o)=>a.login&&a.login(...o),["prevent"]))},[Ce,s.errorMsg.length>0?(c(),l("span",Ee,x(s.errorMsg),1)):y("",!0),r("div",He,[Re,d(r("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=o=>s.email=o),type:"text"},null,512),[[p,s.email]])]),r("div",Oe,[je,d(r("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=o=>s.password=o),type:"text"},null,512),[[p,s.password]])]),Be,r("div",qe,[Je,r("button",{onClick:e[2]||(e[2]=(...o)=>a.hasAccount&&a.hasAccount(...o))},"Register")])],32)}var Ke=m(De,[["render",We],["__scopeId","data-v-5e209e2c"]]);const Ye={name:"Register",data(){return{email:"",password:"",repeatPassword:"",username:"",firstName:"",lastName:"",extraToggle:!1,errorMsg:""}},methods:{async onSubmit(t){this.errorMsg="",this.email.trim()!==""&&this.password.trim()!==""&&this.repeatPassword.trim()!==""?this.password.trim()===this.repeatPassword.trim()?await this.createUser(t):this.errorMsg="Passwords don't match":this.errorMsg="Email and Password are required!"},async createUser(t){const{email:e,password:n,username:i,firstName:s,lastName:a}=Object.fromEntries(new FormData(t.target)),o={username:i,password:n,firstName:s,lastName:a,email:e},g=await R.registerUser(o);g.status===201?(this.email="",this.password="",this.repeatPassword="",this.username="",this.firstName="",this.lastName="",this.errorMsg=""):g.status===422?this.errorMsg="Email already in use":this.errorMsg="Something went wrong, try again later"},hasAccount(){this.$emit("toggle-form",!0)}}},_=t=>($("data-v-9807cb52"),t=t(),k(),t),ze=_(()=>r("h1",null,"Register",-1)),Ge={key:0,class:"error"},Qe={class:"input"},Xe=_(()=>r("label",{for:"email"},"email",-1)),Ze=_(()=>r("label",{class:"extra-details",for:"extraToggle"},"Extra details...",-1)),et={class:"extra"},tt={class:"input"},st=_(()=>r("label",{for:"username"},"username",-1)),ot={class:"input"},rt=_(()=>r("label",{for:"firstName"},"first",-1)),at={class:"input"},nt=_(()=>r("label",{for:"lastName"},"last",-1)),it={class:"input"},ct=_(()=>r("label",{for:"password"},"password",-1)),lt={class:"input"},dt=_(()=>r("label",{for:"repeatPassword"},"repeat password",-1)),ut=_(()=>r("input",{type:"submit",value:"register"},null,-1)),_t={class:"toggle"},pt=_(()=>r("p",null,"Have an account?",-1));function mt(t,e,n,i,s,a){return c(),l("form",{onSubmit:e[8]||(e[8]=H((...o)=>a.onSubmit&&a.onSubmit(...o),["prevent"]))},[ze,s.errorMsg.length>0?(c(),l("span",Ge,x(s.errorMsg),1)):y("",!0),r("div",Qe,[Xe,d(r("input",{id:"email",name:"email","onUpdate:modelValue":e[0]||(e[0]=o=>s.email=o),type:"text"},null,512),[[p,s.email]])]),d(r("input",{id:"extraToggle",name:"extraToggle","onUpdate:modelValue":e[1]||(e[1]=o=>s.extraToggle=o),type:"checkbox"},null,512),[[Q,s.extraToggle]]),Ze,r("div",et,[r("div",tt,[st,d(r("input",{id:"username",name:"username","onUpdate:modelValue":e[2]||(e[2]=o=>s.username=o),type:"text"},null,512),[[p,s.username]])]),r("div",ot,[rt,d(r("input",{id:"firstName",name:"firstName","onUpdate:modelValue":e[3]||(e[3]=o=>s.firstName=o),type:"text"},null,512),[[p,s.firstName]])]),r("div",at,[nt,d(r("input",{id:"lastName",name:"lastName","onUpdate:modelValue":e[4]||(e[4]=o=>s.lastName=o),type:"text"},null,512),[[p,s.lastName]])])]),r("div",it,[ct,d(r("input",{id:"password",name:"password","onUpdate:modelValue":e[5]||(e[5]=o=>s.password=o),type:"text"},null,512),[[p,s.password]])]),r("div",lt,[dt,d(r("input",{id:"repeatPassword",name:"repeatPassword","onUpdate:modelValue":e[6]||(e[6]=o=>s.repeatPassword=o),type:"text"},null,512),[[p,s.repeatPassword]])]),ut,r("div",_t,[pt,r("button",{onClick:e[7]||(e[7]=(...o)=>a.hasAccount&&a.hasAccount(...o))},"Login")])],32)}var gt=m(Ye,[["render",mt],["__scopeId","data-v-9807cb52"]]);const ht={name:"Home",components:{PostComponent:Me,Login:Ke,Register:gt},data(){return{isLoggedIn:!1,hasAccount:!1}},created(){const{getIsLoggedIn:t}=j();this.isLoggedIn=t()},methods:{toggleForm(t){this.hasAccount=t}}};function vt(t,e,n,i,s,a){const o=v("PostComponent"),g=v("Login"),L=v("Register");return c(),l(M,null,[s.isLoggedIn===!0?(c(),N(o,{key:0})):y("",!0),s.hasAccount===!0&&s.isLoggedIn===!1?(c(),N(g,{key:1,onToggleForm:a.toggleForm},null,8,["onToggleForm"])):y("",!0),s.hasAccount===!1&&s.isLoggedIn===!1?(c(),N(L,{key:2,onToggleForm:a.toggleForm},null,8,["onToggleForm"])):y("",!0)],64)}var ft=m(ht,[["render",vt]]),yt="/assets/mongodb.e2bfe7d8.png",bt="/assets/mongoose.e352560f.png",wt="/assets/expressjs.40799037.svg",xt="/assets/vue.77ba2af1.svg",$t="/assets/vite.17e50649.svg",kt="/assets/node.a2054365.svg";const Pt={name:"About"},It={class:"container"},At=X('<h1 data-v-0e84b287>About the project</h1><dl data-v-0e84b287><dt data-v-0e84b287><span class="mongo" data-v-0e84b287>M</span><span class="express" data-v-0e84b287>E</span><span class="vue" data-v-0e84b287>V</span><span class="node" data-v-0e84b287>N</span> Stack</dt><dd class="mongo" data-v-0e84b287><img alt="mongo" src="'+yt+'" data-v-0e84b287>Mongo DB<span class="mongoose" data-v-0e84b287>+ Mongoose<img alt="mongoose" src="'+bt+'" data-v-0e84b287></span></dd><dd class="express" data-v-0e84b287><img alt="express" src="'+wt+'" data-v-0e84b287>Express.js</dd><dd class="vue" data-v-0e84b287><img alt="vue" src="'+xt+'" data-v-0e84b287>Vue + Vite<img alt="vite" src="'+$t+'" data-v-0e84b287></dd><dd class="node" data-v-0e84b287><img alt="node" src="'+kt+'" data-v-0e84b287>Node</dd></dl>',2),Lt=[At];function St(t,e,n,i,s,a){return c(),l("div",It,Lt)}var Nt=m(Pt,[["render",St],["__scopeId","data-v-0e84b287"]]);const Tt=[{path:"/",name:"Home",component:ft},{path:"/about",name:"About",component:Nt}],Ut=Z({history:ee("/"),routes:Tt,linkExactActiveClass:"active"});te(be).use(Ut).mount("#app");
